# 実装構文

ダイスロールしたものは配列で持つ。最終的な処理は``sum``モードと``count``モードで呼び出すことで明示する事ができる。（デフォルト処理はそれぞれのダイスロールで指定されている）

- 四則演算
  - 通常の四則演算はどちらかが配列であった場合、それを処理してから行う。
- 累乗
- 括弧
- 条件分岐 (>, <, =, <=, >=, !=)
  - 両方が値の場合、真偽値（成否）を返す。
  - 片方が配列の場合、条件を満たすもののみを取り出した新しい配列を返す。
    - その場合、その配列のデフォルトは``count``モードとなる。
  - 両側が配列の場合、右側を処理してから判定を行う。
- モード指定 (``sum (sentence)``と``count (sentence)``)
  - 右の配列の処理を選ぶ。
- 通常ダイスロール (2d4)
  - デフォルトモード:``sum``
- ``d6>=4f1``,``10d6>=4f1``,``d6>=4s1``,``10d6>=4s1``
  - fの数だけ判定に失敗すると強制終了する。(sの場合は成功で強制終了)
- アドバンテージロール (``2d20k1``, ``2d20k-1``)
  - *n<sub>1</sub>* d *n<sub>2</sub>* k *n<sub>3</sub>*：*n<sub>2</sub>* 面ダイスを *n<sub>1</sub>* 個振り、大きなものから *n<sub>3</sub>* 個取り出す。
  - *n<sub>1</sub>* d *n<sub>2</sub>* k -*n<sub>3</sub>*：*n<sub>2</sub>* 面ダイスを *n<sub>1</sub>* 個振り、小さなものから *n<sub>3</sub>* 個取り出す。
- 繰り返し (``repeat [sentence, n]``)
  - sentenceを処理するのをn回繰り返し、n個の配列にする。
  - nに文が入っている場合、そちらも処理する。

# コマンド
- ``/roll [-d] (sentence) ``コマンド：構文を解析し、最終的なデフォルトモードで出力する
  - 動作オプション``-d``は詳細を表示する。途中の配列もすべて出力する。
- ``/sum (sentence)``コマンド：``/roll sum (sentence)``のエイリアス
- ``/count (sentence)``コマンド：``/roll count (sentence)``のエイリアス
- ``/check (sentence)``コマンド：最終的な出力配列の個数が1個以上のとき、成功とする。